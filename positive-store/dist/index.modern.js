import e,{useState as t,useEffect as s}from"react";import a from"flat";import i from"i18next";import{initReactI18next as n,I18nextProvider as o}from"react-i18next";export{useTranslation}from"react-i18next";import{computed as r,action as u,thunk as l,thunkOn as c,persist as d,createTypedHooks as p,createStore as m,StoreProvider as g}from"easy-peasy";export{useStoreRehydrated}from"easy-peasy";import v from"axios";import{setupCache as h}from"axios-cache-adapter";import{enUS as f,fi as y}from"date-fns/locale";import{groupBy as S,values as k,remove as I}from"lodash";import w from"@sanity/client";import b from"@sanity/image-url";function _(){return(_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e}).apply(this,arguments)}var T,E,M,G={app:{actions:{activate_tips:{en:"Activate tips",fi:"Aktivoi vinkit"},cancel:{en:"Cancel",fi:"Peruuta"},confirm:{en:"Please confirm",fi:"Vahvista"},edit:{en:"Edit",fi:"Muokkaa"},got_it:{en:"Got it",fi:"Selvä juttu"},locale:{en:"en-US",fi:"fi-FI"},login:{en:"Login",fi:"Kirjaudu sisään"},log_in:{en:"Log in",fi:"Kirjaudu sisään"},logout:{en:"Logout",fi:"Kirjaudu ulos"},log_out:{en:"Log out",fi:"Kirjaudu ulos"},save:{en:"Save",fi:"Tallenna"},save_changes:{en:"Save changes",fi:"Tallenna muutokset"},submitting:{en:"Submitting",fi:"Lähettäminen"}},arrow:{en:"Arrow",fi:"Nuoli"},confirmations:{ask_discard_changes:{en:"Discard changes?",fi:"Hylkää muutokset?"},discard_changes:{en:"Discard changes",fi:"Hylkää muutokset"},discard_msg:{en:"Your changes will not be saved.",fi:"Muutoksia ei tallenneta."}},crow_tip:{en:"Tip from the crow",fi:"Vinkki varikselta"},email:{en:"Email",fi:"Sähköpostiosoite",example:{en:"email@address.com",fi:"email@address.com"}},errors:{content_unavailable:{en:"Requested content is unfortunately unavailable in your language.",fi:"Hakemaasi sisältöä ei valitettavasti löydy valitsemallesi kielelle."}},footer:{en:"We're Positive Learning Ltd from Finland, but our friends call us Positive",fi:"Positive Learning Oy, tuttavallisemmin Positive"},happy_kids_learn_best:{en:"Happy kids learn best.",fi:"Happy kids learn best."},menus:{account_settings:{en:"Account settings",fi:"Tilin asetukset",family_name:{en:"Family name",fi:"Sukunimi"},given_name:{en:"Given name",fi:"Etunimi"},your_name:{en:"Just one more thing.\nYour name :)",fi:"Vielä yksi asia.\nSinun nimesi :)",msg:{en:"So others can easily recognize you.",fi:"Jotta muiden on helpompi tunnistaa sinut..."}}},main:{contact_support:{en:"Contact support",fi:"Ota yhteyttä"},language:{en:"Language",fi:"Kieli"},sanity_remarks_off:{en:"Hide Sanity remarks",fi:"Piilota Sanity huomiot"},sanity_remarks_on:{en:"Show Sanity remarks",fi:"Näytä Sanity huomiot"}}},tips:{dismiss_toast:{en:"Tip is dismissed. Re-activate tips from the main menu!",fi:"Vinkki on piilotettu. Aktivoi vinkit uudestaan päävalikosta!"},reset_toast:{en:"Tips can be seen again.",fi:"Vinkit ovat jälleen näkyvissä."}},today:{en:"Today",fi:"Tänään"},token:{errors:{request_1:{en:"Requesting a login link failed.",fi:"Linkin tilaaminen ei onnistunut."},request_2:{en:"Make sure you have entered your email address correctly and try again.",fi:"Tarkista syöttämäsi sähköpostiosoite ja kokeile uudelleen."}},request:{en:"Request",fi:"Tilaa",instructions:{en:"Request a login link by entering your email address",fi:"Tilaa uusi kirjautumislinkki sähköpostiisi syöttämällä osoitteesi"}},success:{en:"A login link has been sent to your email address %s!",fi:"Uusi kirjautumislinkki on lähetetty sähköpostiisi %s!"}},type:{en:"Type",fi:"Tyyppi"},videos:{en:"Videos",fi:"Videot"},yesterday:{en:"Yesterday",fi:"Eilen"}},resources:{en:"Resources",fi:"Materiaalia",actions:{download_pdf:{en:"Download PDF",fi:"Lataa PDF"}},book:{en:"Book",fi:"Kirja"},cards:{en:"Cards",fi:"Kortit"},see_the_good_activity_cards:{en:"See the Good ∙ Activity Cards",fi:"Huomaa hyvä ∙ Toimintakortit",desc:{en:"Activity Cards describe what the 26 character strengths are in a nutshell, how you recognize them, and how you can develop them in yourself and others.",fi:"Toimintakorteissa esitellään tiivistetysti, mitä 26 luonteenvahvuutta ovat, miten ne voi havaita ja kuinka niitä voi vahvistaa itsessään ja muissa.\n\nLadattavissa toistaiseksi vain englanniksi."},url:{en:"https://s3.eu-central-1.amazonaws.com/varis-materials/public/resources/SeetheGood-ActivityCards-EN.pdf",fi:"https://s3.eu-central-1.amazonaws.com/varis-materials/public/resources/SeetheGood-ActivityCards-EN.pdf"}},see_the_good_student_cards:{en:"See the Good ∙ Student Cards",fi:"Huomaa hyvä ∙ Oppilaskortit",desc:{en:"Student Cards have been designed to support positive learning in kindergarten, at school and at home. The deck contains Strength Cards (26pcs), Emotion Cards (7pcs), Action Cards (10pcs) and Assessment Cards (5pcs).",fi:"Oppilaskortit on kehitetty tukemaan positiivista kasvatusta päiväkodissa, koulussa ja kotona. Korttipakka sisältää Vahvuuskortit (26kpl), Tunnekortit (7kpl), Työskentely- ja tilannekortit (10kpl) ja Arviointikortit (5kpl)."},url:{en:"https://s3.eu-central-1.amazonaws.com/varis-materials/public/resources/SeetheGood-StudentCards-EN.pdf",fi:"https://s3.eu-central-1.amazonaws.com/varis-materials/public/resources/SeetheGood-StudentCards-FI.pdf"}}},route:{invitation:{actions:{join_group:{en:"Join group",fi:"Liity ryhmään",msg:{en:"You are all set, the invitation has already been accepted.",fi:"Kaikki valmista, olet jo hyväksynyt tämän kutsun."}},sign_up:{en:"Sign up",fi:"Luo tili",msg:{en:"Sign up to join Positive.",fi:"Luo tili liittyäksesi Positiveen."}}},errors:{already_invited:{en:"This person has already been invited.",fi:"Hänet on jo kutsuttu aiemmin."},failed_to_send:{en:"Sending invitation unfortunately failed",fi:"Kutsun lähettäminen valitettavasti epäonnistui"},invitation_not_found:{en:"Invitation not found",fi:"Kutsua ei löytynyt"},invitation_not_found_msg:{en:"The invitation might have been cancelled, addressed to someone else or never even existed.\nPlease request a new invitation.",fi:"Kutsu saattaa olla peruttu, lähetetty jollekin muulle kuin sinulle, tai sitä ei ehkä ikinä ole ollutkaan.\nOle hyvä ja tiedustele uutta kutsua."}},existing_account:{en:"Already have an account?",fi:"Onko sinulla jo käyttäjätili?"},header:{en:"Welcome!",fi:"Tervetuloa!"},message:{en:"invited you to join",fi:"kutsui sinut liittymään ryhmään"},invitations:{en:"Invitations",fi:"Kutsut"},status:{accepted:{en:"Accepted",fi:"Hyväksytty"},success:{en:"Invitation successfully sent to %s",fi:"Kutsu lähetetty osoitteeseen %s"},waiting:{en:"Pending",fi:"Odottaa"}},welcome_to_the_group:{en:"Welcome to the group %s!",fi:"Tervetuloa ryhmään %s!"}},landing:{desc:{learn:{en:"What is positive education about? What has been researched, what has been found to be good in practice?",fi:"Mistä positiivisessa kasvatuksessa on kyse? Mitä on tutkittu, mitä käytännössä hyväksi havaittu?"},see_the_good:{en:"Whenever you see the good, give positive feedback.\nStart now!",fi:"Kun huomaat hyvää, anna positiivista palautetta.\nVoit aloittaa heti!"},teach:{en:"This is how you teach character strengths to children and youth. Here you are the learning materials for teaching 26 different strengths.",fi:"Näin opetat luonteenvahvuuksia lapsille ja nuorille. Täältä oppimateriaalit 26 eri vahvuuden opettamiseen."}},video_url:{en:"https://youtu.be/0esAAdH9fh4",fi:"https://youtu.be/rAyuunywao8"},welcome_msg:{en:"Welcome to See the Good!",fi:"Huomaa hyvä!\nTervetuloa mukaan"}},login:{errors:{unknown:{en:"Login unfortunately failed for an unknown reason.",fi:"Sisäänkirjautuminen ei valitettavasti tuntemattomasta syystä onnistunut."},user_not_found:{en:"Unfortunately we couldn't log you in, user account was not found.",fi:"Sisäänkirjautuminen valitettavasti epäonnistui, käyttäjätunnusta ei löytynyt."}},welcome_message:{en:"Hey, good to\nsee you!",fi:"Hei,\nhauska nähdä!"}},learn:{en:"Learn",fi:"Opi",actions:{next:{en:"Next",fi:"Seuraava"}},articles:{en:"Articles",fi:"Artikkelit"},header:{en:"How to implement positive pedagogy in practice?",fi:"Miten toteuttaa positiivista pedagogiikkaa käytännössä?"},num_videos:{en:"%d videos",fi:"%d videota"}},see_the_good:{en:"See the Good",fi:"Huomaa hyvä",actions:{attach_media:{en:"Attach a photo",fi:"Liitä kuva"},cancel_invitation:{en:"Cancel invitation",fi:"Peruuta kutsu"},change_role:{en:"Change role",fi:"Muuta roolia"},create:{en:"Create",fi:"Luo",group:{en:"Create group",fi:"Luo ryhmä"}},delete:{group:{en:"Delete group",fi:"Poista ryhmä"},moment:{en:"Delete moment",fi:"Poista bongaus"},photo:{en:"Delete photo",fi:"Poista kuva"}},edit:{group:{en:"Edit group",fi:"Muokkaa ryhmää"},post:{en:"Edit post",fi:"Muokkaa julkaisua"}},invite:{en:"Invite",fi:"Kutsu",multiple:{en:"Invite multiple users by separating email addresses with commas.",fi:"Kutsu useampia käyttäjiä erottamalla sähköpostiosoitteet pilkulla."},new_member:{en:"Invite new member",fi:"Kutsu uusi jäsen"},group:{en:"Invite to group",fi:"Kutsu ryhmään"}},leave:{en:"Leave",fi:"Poistu",group:{en:"Leave from group",fi:"Poistu ryhmästä"}},remove:{en:"Remove",fi:"Poista",from_group:{en:"Remove from group",fi:"Poista ryhmästä"}},select_group:{en:"Select group",fi:"Valitse ryhmä"},spot_strength:{en:"Spot strength",fi:"Bongaa vahvuus"}},confirmations:{delete:{group:{msg_1:{en:"Are you sure you want to delete the group?",fi:"Haluatko varmasti poistaa ryhmän?"},msg_2:{en:"If you delete the group, all data for this group will be lost.",fi:"Jos poistat ryhmän, kaikki ryhmälle luotu tieto menetetään."}}},downgrade_role:{en:"Are you sure you want to change your role in this group? If you change your role, you cannot change it back.",fi:"Haluatko varmasi muuttaa rooliasi ryhmässä? Jos muutat rooliasi, et voi muuttaa sitä enää takaisin."},leave_group:{en:"Are you sure you want to leave from group?",fi:"Haluatko varmasti poistua ryhmästä?"},invitation:{en:"Are you sure you want to cancel the invitation?",fi:"Haluatko varmasti peruuttaa kutsun?"},memberships:{en:"Are you sure you want to remove the user from group?",fi:"Haluatko varmasti poistaa käyttäjän ryhmästä?"},moment:{en:"Are you sure you want to remove the strength spotting?",fi:"Haluatko varmasti poistaa vahvuusbongauksen?"}},errors:{create_group:{en:"Something went wrong when creating the group",fi:"Ryhmän luominen ei onnistunut"},canceling_invitation:{en:"Error canceling invitation :(",fi:"Virhe kutsua peruttaessa :("},fetching_group_invitations:{en:"Error loading the group invitation listing :(",fi:"Virhe ryhmän kutsuja ladatessa :("},fetching_group_members:{en:"Error loading the group member listing :(",fi:"Virhe ryhmän jäsenlistaa ladatessa :("},invalid_email:{en:"Please enter a valid email",fi:"Tarkista sähköpostiosoite"},invalid_group:{en:"Requested group could not be found",fi:"Haettua ryhmää ei löytynyt"},invalid_input_length:{en:"Please enter between %d and %d characters",fi:"Ole hyvä ja kirjoita %d - %d kirjainta"},member_already_exists:{en:"This person is already a member of this group.",fi:"Hän on jo tämän ryhmän jäsen."},updating_membership:{en:"Error updating group member information :(",fi:"Virhe ryhmän jäsenen tietoja muutettaessa :("},updating_user:{en:"Error updating user information :(",fi:"Virhe käyttäjän tietoja muutettaessa :("}},feed:{first_moment_tip:{en:"Great! %s got its first positive feedback!\nKeep on Seeing the Good!",fi:"Upeaa! %s sai ensimmäisen positiivisen palautteen!\nHuomatkaa hyvä jatkossakin!"}},from:{en:"From",fi:"Keneltä"},group:{name:{en:"Group name",fi:"Ryhmän nimi"},tip_1:{en:"Group tab is for managing the members of your group, eg. a school class.",fi:"Ryhmä -välilehdellä hallinnoidaan ryhmän, esim. koululuokan jäseniä."},tip_2:{en:"For now you may only invite other managers, eg. other teachers into the group. However, soon we will support other roles as well.",fi:"Toistaiseksi voit kutsua ryhmään vain toisia hallinnoijia, esim. toisia opettajia. Jatkossa tuemme myös muita rooleja."}},manage_organization:{en:"Manage organization",fi:"Hallinnoi organisaatiota"},member_role:{en:"Member role",fi:"Jäsenen rooli"},members:{en:"Members",fi:"Jäsenet"},menu:{feed:{en:"Feed",fi:"Feedi"},group:{en:"Group",fi:"Ryhmä"},insights:{en:"Insights",fi:"Yhteenveto"}},modal:{actions:{edit_post:{en:"Edit post",fi:"Muokkaa julkaisua"}},step_1:{en:"Step %s/2: Select Strength",fi:"%s/2: Valitse vahvuus",power_strengths:{en:"Power strengths",fi:"Voimavahvuudet"},more_strengths:{en:"More trengths",fi:"Lisää vahvuuksia"},tip_1:{en:"Helping friends is an example of Kindness and focusing on your task is an example of Self-regulation.",fi:"Kaverin auttaminen on esimerkki ystävällisyydestä ja keskittyminen annettuun tehtävään on esimerkki itsesäätelystä."},tip_2:{en:"Select a strength to discover more examples of strengths in action!",fi:"Valitse vahvuus löytääksesi lisää esimerkkejä vahvuuksien käytöstä!"}},step_2:{en:"Step %s/2: Include Details",fi:"%s/2: Lisätietoja",desc:{en:"Describe use of strength...",fi:"Kuvaile vahvuuden käyttöä..."},examples:{en:"Examples of strength in action",fi:"Esimerkkejä vahvuuden käytöstä"},tip_1:{en:"Enriching feedback with a description makes it more meaningful to the receiver.",fi:"Kuvailemalla vahvuuden käyttöä palautteesta tulee vastaanottajalle merkityksellisempi."},tip_2:{en:"Use the examples from below, write your own, or just save without!",fi:"Valitse esimerkki listasta, kuvaile tapahtumaa omin sanoin tai tallenna ilman kuvausta."}}},moments:{en:"Moments",fi:"Hetket"},no_group_selected:{en:"Create a group to start spotting strengths.",fi:"Luo ryhmä alkaaksesi bongaamaan vahvuuksia."},no_groups:{en:"No groups",fi:"Ei ryhmiä",actions:{create_group:{en:"Create group",fi:"Luo ryhmä"}},group_name:{en:"Your group name",fi:"Ryhmäsi nimi"},page_title:{en:"Seeing the Good in your group promotes learning",fi:"Hyvän huomaaminen ryhmässäsi edistää oppimista"},placeholder:{en:"2A, Seahorses...",fi:"2A, Merihevoset..."},tip:{en:"Let's start by creating a group!",fi:"Aloitetaan luomalla ryhmä!"}},no_moments:{en:"%s, start showing your strengths and they will be spotted!",fi:"%s, näyttäkää vahvuutenne ja alkakaa bongaamaan!",page_title:{en:"%s, let's See the Good together",fi:"%s, huomataan yhdessä hyvää"},sub_heading:{en:"Seeing the Good is about making strength usage visible",fi:"Hyvän huomaaminen on vahvuuksien käytön näkyväksi tekemistä"},tip:{en:"Give your first positive feedback,\npress plus button!",fi:"Anna positiivista palautetta,\npaina plussaa!"},watch_video:{en:"Watch how",fi:"Näin se käy"}},only_group_manager:{en:"You are the only Manager in the group.\n\nTo change your role or leave the group, please first make sure there is another Manager in the group.",fi:"Olet ryhmän ainoa hallinnoija.\n\nVaihtaaksesi rooliasi tai poistuaksesi ryhmästä, ole hyvä ja varmista ensin että ryhmällä on toinen hallinnoija."},organization:{en:"Organization",fi:"Organisaatio",name:{en:"Organization name",fi:"Organisaatio nimi"},tip_1:{en:"Organization tab is for managing the members of your organization, eg. a school.",fi:"Organisaatio -välilehdellä hallinnoidaan organisaation, esim. koulun jäseniä."},tip_2:{en:"As an organization manager you may invite members, eg. teachers into the organization. Members create groups of their own and manage members of their groups independently.",fi:"Organisaation hallinnoijana voit kutsua jäseniä, esim. opettajia, organisaation jäseniksi. Jäsenet luovat organisaatioon omia ryhmiään ja hallinnoivat niiden jäseniä itsenäisesti."}},other_groups:{en:"Other groups",fi:"Muut ryhmät"},plus_others:{en:"+ %s others",fi:"+ %s muuta"},progress:{en:"Progress",fi:"Kehitys"},roles:{class:{manager:{en:"Manager",fi:"Hallinnoija",desc:{en:"For example, teacher\n• Manage group members and content\n• Spot strengths\n• View strengths spottings",fi:"Esim. opettaja\n• Hallinnoi ryhmän jäseniä ja sisältöä\n• Bongaa vahvuuksia\n• Lukee vahvuusbongauksia"}},spotter:{en:"Spotter",fi:"Bongaaja",desc:{en:"For example, co-teacher or student\n• Spot strengths\n• View strengths spottings",fi:"Esim. toinen opettaja tai oppilas\n• Bongaa vahvuuksia\n• Lukee vahvuusbongauksia"}},viewer:{en:"Viewer",fi:"Lukija",desc:{en:"For example, student\n• View strength spottings",fi:"Esim. oppilas\n• Lukee vahvuusbongauksia"}}},more_coming_soon:{en:"More roles coming soon!",fi:"Lisää rooleja tulossa pian!"},organization:{manager:{en:"Manager",fi:"Hallinnoija",desc:{en:"For example, IT support or teacher\n• Manage members of the organization\n• Create and manage groups for e.g. students",fi:"Esim. IT-tukihenkilö tai opettaja\n• Hallinnoi organisaation jäseniä\n• Luo ja hallinnoi ryhmiä esim. oppilaille"}},member:{en:"Member",fi:"Jäsen",desc:{en:"For example, teacher\n• Create and manage groups for e.g. students",fi:"Esim. opettaja\n• Luo ja hallinnoi ryhmiä esim. oppilaille"}}}},strengths:{en:"Strengths",fi:"Vahvuudet"},to:{en:"To",fi:"Kenelle"},your_groups:{en:"Your groups",fi:"Sinun ryhmäsi"}},teach:{en:"Teach",fi:"Opeta",actions:{download_ppt:{en:"Download Powerpoint",fi:"Lataa Powerpoint"}},duration:{en:"Duration",fi:"Kesto"},exercise:{additional_exercises:{en:"Additional exercises",fi:"Harjoitukset"},additional_exercises_preschool:{en:"Additional exercises",fi:"Harjoitukset"},basics:{en:"Basics",fi:"Perusteet"},basics_preschool:{en:"Basics",fi:"Oppituokiot"},lesson:{part:{en:"Part of a lesson",fi:"Osa tuntia"},project:{en:"Project",fi:"Projekti"},whole:{en:"Whole lesson",fi:"Koko tunti"}},group:{en:"Entire group exercise",fi:"Koko ryhmän tehtävä"},homework:{en:"Homework",fi:"Kotitehtävä"},individual:{en:"Individual exercise",fi:"Yksilötehtävä"},pair:{en:"Pair exercise",fi:"Paritehtävä"},small_group:{en:"Small group exercises",fi:"Pienryhmätehtävä"},teacher:{en:"Exercise for teacher",fi:"Tehtävä opettajalle"},xmas_doors:{en:"Doors",fi:"Luukut"}},exercises:{en:"Exercises",fi:"Harjoitukset"},find_lesson_plans:{en:"Find ready made lesson plans and engaging activities",fi:"Täältä löydät oppituntikokonaisuuksia ja innostavia tehtäviä"},how_to_find_strengths:{en:"How to find the strengths",fi:""},more_strengths:{en:"More strengths",fi:"Lisää vahvuuksia"},power_strengths:{en:"Power strengths",fi:"Voimavahvuudet",desc:{en:"Welcome to teach character strengths. All strengths are needed, but three of them, the so-called power strengths are particularly important.",fi:"Tervetuloa opettamaan luonteenvahvuuksia. Kaikkia vahvuuksia tarvitaan, mutta kolme niistä, ns. voimavahvuudet ovat erityisen tärkeitä."}},teach_character_strengths:{en:"Teach character strengths",fi:"Opeta luonteenvahvuuksia"},teacher_guide:{en:"Teacher's Guide",fi:"Opettajan opas"},wave_of_strengths:{en:"Wave of strengths",fi:"Opeta vahvuuksia aalloissa"},wave:{en:"Wave %d: %s",fi:"Aalto %d: %s"},waves_desc:{en:'Teach strengths in waves. After the power strengths, you can introduce strength sets as suggested below. It is good to teach intrapersonal (e. g. self-regulation) and interpersonal (e.g. kindness) strengths in the same wave. Furthermore, teaching in the same wave the strengths of "heart" (e.g. compassion) and "head" (e.g. carefulness) pays off.  Of course, feel free to choose which strength you focus on at any given time.',fi:'Jatka vahvuuksien opetusta aaltoina. Voimavahvuuksien jälkeen seuraavassa aallossa voit esitellä  alla olevia vahvuuskimppuja.  On hyvä opettaa samassa aallossa yksilöön ja ryhmään kohdistuvia vahvuuksia (kuten itsesäätely ja ystävällisyys) sekä "sydämen" (myötätunto) ja "pään" (harkitsevuus) vahvuuksia. Voit toki myös vapaasti valita, mihin vahvuuteen kulloinkin keskitytte.'}}}};!function(e){e.fi="fi",e.en="en"}(T||(T={})),function(e){e.light="light",e.dark="dark"}(E||(E={})),function(e){e.development="development",e.staging="staging",e.production="production"}(M||(M={}));const A=(e,t)=>{const s=-1*t.length;return Object.keys(e).filter(e=>e.slice(s)===t).reduce((s,a)=>(s[a.slice(0,a.length-(t.length+1))]=e[a],s),{})},x=({children:r,translations:u})=>{const[l,c]=t(!1),{language:d}=Ut(),p=a(u||G),m={en:{translation:_({},A(p,T.en))},fi:{translation:_({},A(p,T.fi))}};return s(()=>{l||(c(!0),i.use(n).init({lng:d,fallbackLng:T.fi,keySeparator:!1,resources:m}))},[l,c,i,n,d,m]),s(()=>{d&&i.changeLanguage(d)},[d,i]),e.createElement(o,{i18n:i},r)},j=process.env.REACT_APP_API_BASE_URL,R=h({maxAge:9e5,clearOnStale:!1,readOnError:!0,invalidate:async(e,t)=>{t.clearCacheEntry&&await e.store.removeItem(e.uuid)}}),C=v.create({baseURL:j,withCredentials:!0,headers:{"Content-Type":"application/json; charset=utf-8"},adapter:R.adapter});var $,q;C.interceptors.response.use(e=>e,e=>{var t;if(404===(null===(t=e.response)||void 0===t?void 0:t.status))throw new Error(e.config.url+" not found");throw e}),function(e){e.goals="goals",e.groups="groups",e.invitations="invitations",e.media="/medias",e.members="members",e.session="session"}($||($={})),function(e){e.fetchGroups="fetchGroups",e.setSelectedGroup="setSelectedGroup",e.createGroup="createGroup",e.editGroup="editGroup",e.deleteGroup="deleteGroup"}(q||(q={}));const D=(e,t)=>[e,t].filter(Boolean).join(" "),P=e=>({id:e.id}),L=e=>({user:{id:e.ID,familyName:e.FamilyName,givenName:e.GivenName,name:[e.GivenName,e.FamilyName].filter(Boolean).join(" ")},role:e.Role}),O=e=>({role:e.role,user:P(e.user)}),V=e=>{var t,s,a,i,n;return{id:e.ID,email:e.Email,role:e.Role,status:e.Status,group_id:e.GroupID,creator:{id:null===(t=e.Creator)||void 0===t?void 0:t.ID,name:D(null===(s=e.Creator)||void 0===s?void 0:s.GivenName,null===(a=e.Creator)||void 0===a?void 0:a.FamilyName),givenName:null===(i=e.Creator)||void 0===i?void 0:i.GivenName,familyName:null===(n=e.Creator)||void 0===n?void 0:n.FamilyName},type:e.Type}},U=e=>({id:e.id,role:e.role,status:e.status,group_id:e.group_id,creator:P(e.creator)});var F,N;!function(e){e.class="class",e.organization="organization"}(F||(F={})),function(e){e.manager="owner",e.member="tutor",e.none=""}(N||(N={}));const H=e=>(e=>e.type===F.class)(e)&&!e.parentGroup,K=e=>e.type===F.organization,z=e=>e.map(e=>({id:e.ID,name:e.Name,userRole:e.UserRole,type:e.Type,parentGroup:e.ParentGroup?{id:e.ParentGroup.ID,name:e.ParentGroup.Name,type:e.ParentGroup.Type,userRole:e.ParentGroup.UserRole}:void 0})).sort((e,t)=>{var s,a;const i=(null===(s=e.name)||void 0===s?void 0:s.toUpperCase())||"",n=(null===(a=t.name)||void 0===a?void 0:a.toUpperCase())||"";return i<n?-1:i>n?1:0});var B;!function(e){e.complete="complete",e.idle="idle",e.loading="loading"}(B||(B={}));const W={error:{},groups:[],hasSelectableGroups:r(e=>{var t,s;return(null===(t=e.groups)||void 0===t?void 0:t.length)>0||(null===(s=e.orphanGroups)||void 0===s?void 0:s.length)>0}),nameMaxLength:32,nameMinLength:1,organizations:r(({groups:e})=>e.filter(K)),orphanGroups:r(({groups:e})=>e.filter(H)),restrictedAccount:r(e=>(e=>{const t=((e,t=!1)=>e.filter(e=>e.type===F.organization).filter(e=>!t||e.userRole===N.manager))(e||[]).length>0;return(e||[]).filter(e=>e.parentGroup).length>0&&!t})(e.groups)),requestTimestamps:{fresh:0,stale:0},selectedGroup:void 0,selectedGroupId:void 0,status:Object.keys(q).reduce((e,t)=>_({},e,{[q[t]]:B.idle}),{})},J={setError:u((e,t)=>{e.error[t.type]=t.value}),setGroups:u((e,t)=>{e.groups=t.groups}),setRequestTimestamps:u((e,t)=>{e.requestTimestamps[t.type]=t.value}),setSelectedGroup:u((e,t)=>{e.selectedGroup=t}),setSelectedGroupId:u((e,t)=>{e.selectedGroupId=t}),setStatus:u((e,t)=>{e.status[t.type]=t.value})};var Y;!function(e){e.fresh="fresh",e.stale="stale"}(Y||(Y={}));const X={createGroup:l(async(e,t,{getState:s,getStoreActions:a,injections:{client:i}})=>{e.setStatus({type:q.createGroup,value:B.loading}),await a().auth.silentRefresh();const n=s().groups;try{await a().auth.silentRefresh();const[s]=await i.post(t.parentGroupId?(({groupId:e})=>`/${$.groups}/${e}/subgroups`)({groupId:t.parentGroupId}):`/${$.groups}/`,t).then(({data:e})=>z([e])),o=n.concat(s);o&&e.setGroups({groups:o}),e.setSelectedGroupId(s.id),e.setError({type:q.createGroup,value:void 0})}catch(t){var o;e.setError({type:q.createGroup,value:{error:t,status:null===(o=t.response)||void 0===o?void 0:o.status}})}finally{e.setRequestTimestamps({type:Y.stale,value:Date.now()}),e.setStatus({type:q.createGroup,value:B.complete})}}),deleteGroup:l(async(e,t,{getState:s,getStoreActions:a,injections:{client:i}})=>{e.setStatus({type:q.deleteGroup,value:B.loading}),await a().auth.silentRefresh();const n=s().groups;try{await a().auth.silentRefresh(),await i.delete((({groupId:e})=>`/${$.groups}/${e}`)(t));const s=n.filter(e=>e.id!==t.groupId)||[];e.setGroups({groups:s}),e.setError({type:q.deleteGroup,value:void 0})}catch(t){var o;e.setError({type:q.deleteGroup,value:{error:t,status:null===(o=t.response)||void 0===o?void 0:o.status}})}finally{e.setRequestTimestamps({type:Y.stale,value:Date.now()}),e.setStatus({type:q.deleteGroup,value:B.complete})}}),editGroup:l(async(e,t,{getState:s,getStoreActions:a,injections:{client:i}})=>{e.setStatus({type:q.editGroup,value:B.loading}),await a().auth.silentRefresh();const n=s().groups;try{await a().auth.silentRefresh(),await i.put((({groupId:e})=>`/${$.groups}/${e}`)({groupId:t.group.id}),t.group).then(()=>{const s=null==n?void 0:n.map(e=>e.id===t.group.id?_({},e,t.group):e);s&&e.setGroups({groups:s}),e.setError({type:q.editGroup,value:void 0})})}catch(t){var o;e.setError({type:q.editGroup,value:{error:t,status:null===(o=t.response)||void 0===o?void 0:o.status}})}finally{e.setRequestTimestamps({type:Y.stale,value:Date.now()}),e.setStatus({type:q.editGroup,value:B.complete})}}),fetchGroups:l(async(e,t,{getState:s,getStoreActions:a,injections:{client:i}})=>{if(s().status[q.fetchGroups]===B.idle){e.setStatus({type:q.fetchGroups,value:B.loading}),await a().auth.silentRefresh();try{const{requestTimestamps:{fresh:a,stale:n}}=s(),o=a<n,r=await i.get((null==t?void 0:t.groupId)?(({groupId:e})=>`/${$.groups}/${e}`)({groupId:t.groupId}):"/"+$.groups,{clearCacheEntry:o}).then(({data:e})=>(e=>e.map(t=>_({},t,{childGroups:t.type===F.organization?e.filter(({parentGroup:e})=>e&&e.id===t.id):void 0})))(z(Array.isArray(e)?e:[e])));e.setGroups({groups:r}),e.setError({type:q.fetchGroups,value:void 0})}catch(t){var n;e.setError({type:q.fetchGroups,value:{error:t,status:null===(n=t.response)||void 0===n?void 0:n.status}})}finally{e.setRequestTimestamps({type:Y.fresh,value:Date.now()}),e.setStatus({type:q.fetchGroups,value:B.complete})}}})},Q={onSetGroups:c(e=>[e.setGroups],async(e,t,{getState:s})=>{const a=s(),{groups:i}=t.payload,n=a.selectedGroupId;let o;if(n&&i.find(e=>e.id===n))o=n;else if(i.length){const e=i.find(e=>e.type===F.class);o=e?e.id:i[0].id}e.setSelectedGroupId(o||void 0)}),onSetSelectedGroupId:c(e=>[e.setSelectedGroupId],async(e,t,{getStoreState:s,getStoreActions:a})=>{e.setStatus({type:q.setSelectedGroup,value:B.loading});try{const{groups:i}=s().groups,n=t.payload,o=null==i?void 0:i.find(e=>e.id===n);if(!n||!o)return void e.setSelectedGroup(void 0);let r=!1;await a().memberships.fetchMemberships({groupId:n}),o.userRole===N.manager&&(r=!0,await a().invitations.fetchInvitations({groupId:o.id})),e.setSelectedGroup(_({},o,{invitations:r?s().invitations.invitations:[],memberships:s().memberships.memberships})),e.setError({type:q.setSelectedGroup,value:void 0})}catch(t){var i;e.setError({type:q.setSelectedGroup,value:{error:t,status:null===(i=t.response)||void 0===i?void 0:i.status}})}finally{const{moments:t,goals:s,memberships:i,invitations:n}=a();Promise.all([t,s,i,n].map(e=>e.setRequestTimestamps({type:Y.stale,value:Date.now()}))),e.setStatus({type:q.setSelectedGroup,value:B.complete})}}),onSetStatus:c(e=>e.setStatus,(e,t)=>{t.payload.value===B.complete&&e.setStatus({type:t.payload.type,value:B.idle})})},Z={storage:"localStorage",allow:["groups","selectedGroup","selectedGroupId","organizations","orphanGroups"]},ee=_({},J,Q,W,X),te={language:T.fi,locale:r(({language:e})=>ie[e]),theme:E.light,env:M.development},se={setLanguage:u((e,t)=>{e.language=t}),setTheme:u((e,t)=>{e.theme=t})},ae={onSetLanguage:c(e=>[e.setLanguage],async(e,t,{getStoreActions:s})=>{const{audiences:{setAudiences:a,setRawAudiences:i,setActiveAudienceSlug:n},exercises:{setExercises:o},strengths:{setStrengths:r,setPositiveCV:u,setXmasCalendar:l,setStartingLesson:c}}=s();a([]),i([]),n(void 0),o([]),r([]),u(void 0),l(void 0),c(void 0)})},ie={[T.en]:f,[T.fi]:y},ne={storage:"localStorage",allow:["theme","language"]},oe=_({},te,se,ae),re={setActiveAudienceSlug:u((e,t)=>{e.activeAudienceSlug=t}),setAudiences:u((e,t)=>{e.audiences=t}),setError:u((e,t)=>{e.error[t.type]=t.value}),setRawAudiences:u((e,t)=>{e.rawAudiences=t}),setRequestTimestamps:u((e,t)=>{e.requestTimestamps[t.type]=t.value}),setStatus:u((e,t)=>{e.status[t.type]=t.value})},ue={onSetStatus:c(e=>e.setStatus,(e,t)=>{t.payload.value===B.complete&&e.setStatus({type:t.payload.type,value:B.idle})})},le={fi:"students-v2",en:"students-v1"};var ce;(ce||(ce={})).fetchAudiences="fetchAudiences";const de=(e,t,s)=>e.find(e=>e[t]===s),pe={error:{},audiences:[],activeAudience:r(e=>de(e.rawAudiences,"slug",(null==e?void 0:e.activeAudienceSlug)||e.defaultAudienceSlug)),activeAudienceSlug:le[T.fi],defaultAudienceSlug:r([(e,t)=>t.settings.language],e=>le[e]),rawAudiences:[],requestTimestamps:{fresh:0,stale:0},status:Object.keys(ce).reduce((e,t)=>_({},e,{[ce[t]]:B.idle}),{})},me={fetchAudiences:l(async(e,t,{getState:s,getStoreState:a,getStoreActions:i})=>{e.setStatus({type:ce.fetchAudiences,value:B.loading}),await i().auth.silentRefresh();const{sanity:{sanityClient:n},settings:{env:o,language:r}}=a();try{const a=(await n.fetch("*[_type == 'audience' && defined(translations[$language])]\n{\n  _id, live, \"slug\": slug.current, orderNumber, ...translations{...@[$language]}\n\n  , \"numExercises\": count(*[_type == 'exerciseV2' && references(^._id)]\n    {\"translationCount\": count(*[_type == 'exerciseV2Translation' && exerciseV2._ref == ^._id && language == $language])}\n    [ translationCount > 0 ])\n\n} | order(orderNumber asc)",{language:t||r})).map(e=>({id:e._id,live:e.live,name:e.name,slug:e.slug,numExercises:e.numExercises}));let i=[...a];const u=s().defaultAudienceSlug;o===M.production&&(i=((e,t)=>e.filter(e=>(!e.slug.startsWith("students-")||e.slug===t)&&e.numExercises>0))(a,u)),e.setRawAudiences(a),e.setAudiences(i),e.setActiveAudienceSlug(u),e.setError({type:ce.fetchAudiences,value:void 0})}catch(t){var u;e.setError({type:ce.fetchAudiences,value:{error:t,status:null===(u=t.response)||void 0===u?void 0:u.status}})}finally{e.setRequestTimestamps({type:Y.fresh,value:Date.now()}),e.setStatus({type:ce.fetchAudiences,value:B.complete})}})},ge=d(_({},re,ue,pe,me),{storage:"localStorage",allow:["activeAudienceSlug"]}),ve={setError:u((e,t)=>{e.error[t.type]=t.value}),setIdToken:u((e,t)=>{e.idToken=t}),setIdTokenExpiresAt:u((e,t)=>{e.idTokenExpiresAt=t}),setIsInitialized:u((e,t)=>{e.isInitialized=t}),setRequest:u((e,t)=>{e.request[t.type]=t.value}),setSessionExpiresAt:u((e,t)=>{e.sessionExpiresAt=t}),setStatus:u((e,t)=>{e.status[t.type]=t.value})},he={onSetStatus:c(e=>e.setStatus,(e,t)=>{t.payload.value===B.complete&&e.setStatus({type:t.payload.type,value:B.idle})})};var fe;!function(e){e.authenticate="authenticate",e.initialize="initialize",e.logout="logout",e.postIdToken="postIdToken",e.refresh="refresh",e.silentRefresh="silentRefresh"}(fe||(fe={}));const ye={error:{},idToken:void 0,idTokenExpiresAt:void 0,idTokenExpiresIn:r(e=>()=>void 0!==e.idTokenExpiresAt?Math.floor((1e3*e.idTokenExpiresAt-Date.now())/1e3):void 0),isInitialized:!1,sessionExpiresAt:void 0,sessionExpiresIn:r(e=>()=>void 0!==e.sessionExpiresAt?Math.floor((1e3*e.sessionExpiresAt-Date.now())/1e3):void 0),request:Object.keys(fe).reduce((e,t)=>_({},e,{[fe[t]]:void 0}),{}),status:Object.keys(fe).reduce((e,t)=>_({},e,{[fe[t]]:B.idle}),{})},Se=_({},ve,he,ye,{authenticate:l(async()=>console.log("This is a no-op, to be declared in UI package.")),initialize:l(async()=>console.log("This is a no-op, to be declared in UI package.")),logout:l(async()=>console.log("This is a no-op, to be declared in UI package.")),postIdToken:l(async(e,t,{getState:s,getStoreActions:a,getStoreState:i,injections:{client:n}})=>{if(s().status.postIdToken===B.idle){e.setStatus({type:fe.postIdToken,value:B.loading});try{const s=await n.post((({language:e})=>`/${$.session}?lang=${e}`)({language:t.language}),void 0,{headers:{Authorization:"Bearer "+t.idToken}}).then(e=>{return(null==e?void 0:e.data)?{id:(t=e.data).ID,email:t.Email,givenName:t.GivenName,familyName:t.FamilyName,name:D(t.GivenName,t.FamilyName)}:void 0;var t});if(!s)throw new Error("Id token post request response is invalid.");e.setSessionExpiresAt(Math.floor(Date.now()/1e3+1200)),i().user.user||a().user.setUser(s),e.setError({type:fe.postIdToken,value:void 0})}catch(t){var o;a().user.setUser(void 0),e.setError({type:fe.postIdToken,value:{error:t,status:null===(o=t.response)||void 0===o?void 0:o.status}})}finally{e.setStatus({type:fe.postIdToken,value:B.complete})}}}),refresh:l(async()=>console.log("This is a no-op, to be declared in UI package.")),requestCode:l(async()=>console.log("This is a no-op, to be declared in UI package.")),requestTokens:l(async()=>console.log("This is a no-op, to be declared in UI package.")),silentRefresh:l(async()=>console.log("This is a no-op, to be declared in UI package."))}),ke={setActiveExerciseSlug:u((e,t)=>{e.activeExerciseSlug=t}),setError:u((e,t)=>{e.error[t.type]=t.value}),setExercises:u((e,t)=>{e.exercises=t}),setRequestTimestamps:u((e,t)=>{e.requestTimestamps[t.type]=t.value}),setStatus:u((e,t)=>{e.status[t.type]=t.value})},Ie={onSetStatus:c(e=>e.setStatus,(e,t)=>{t.payload.value===B.complete&&e.setStatus({type:t.payload.type,value:B.idle})})};var we,be,_e;(we||(we={})).fetchExercises="fetchExercises",function(e){e.additionalExercises="ADDITIONAL_EXERCISES",e.basics="BASICS",e.christmasCalendar="CHRISTMAS_CALENDAR",e.exercises="EXERCISES",e.firstLesson="FIRST_LESSON",e.forTeacher="FOR_TEACHER",e.homework="HOMEWORK",e.quickExercises="QUICK_EXERCISES"}(be||(be={})),function(e){e.additionalExercises="additional_exercises",e.basics="basics",e.christmasCalendar="xmas_doors",e.exercises="exercises",e.firstLesson="first_lesson",e.forTeacher="for_teacher",e.homework="homework",e.quickExercises="quick_exercises"}(_e||(_e={}));const Te=e=>{if(!e)throw new Error("isDraftID called with no id. This is likely caused by the GROQ query not including _id");return e.startsWith("drafts.")},Ee={error:{},activeExercise:r(e=>e.activeExerciseSlug&&de(e.exercises,"slug",e.activeExerciseSlug)),activeExerciseSlug:void 0,exercises:[],exerciseSections:r(e=>(e=>{const t=S(e,e=>e.section);return[{key:_e.forTeacher,exercises:t[be.forTeacher]},{key:_e.basics,exercises:t[be.basics]||t[be.firstLesson]},{key:_e.exercises,exercises:t[be.exercises]||t[be.additionalExercises]},{key:_e.quickExercises,exercises:t[be.quickExercises]},{key:_e.homework,exercises:t[be.homework]},{key:_e.christmasCalendar,exercises:t[be.christmasCalendar]}].filter(e=>e.exercises)})(e.exercises)),requestTimestamps:{fresh:0,stale:0},status:Object.keys(we).reduce((e,t)=>_({},e,{[we[t]]:B.idle}),{})},Me={fetchExercises:l(async(e,t,{getStoreActions:s,getStoreState:a})=>{e.setStatus({type:we.fetchExercises,value:B.loading}),await s().auth.silentRefresh();const{audiences:{activeAudienceSlug:i,defaultAudienceSlug:n},sanity:{sanityClient:o,verboseContent:r},settings:{language:u},strengths:{activeStrength:l}}=a();try{const s=((e,t)=>e.map(e=>{const s=Te(e._id),a=_({},e,{id:e._id,slug:s?"draft-version-"+e.slug:e.slug,title:s&&t?e.title+" [DRAFT]":e.title});return delete a._id,a}))(await o.fetch('*[_type == \'exerciseV2Translation\' &&\n  language == $language &&\n  $strengthSlug in exerciseV2->strengthV2s[]->slug.current &&\n  $audienceSlug in exerciseV2->audiences[]->slug.current\n]{\n  _id, language, slides, title, description, showCover,\n\n  ...exerciseV2->{"slug": slug.current, section, type, duration, orderNumber},\n\n  slides[]{\n    ...,\n    body[]{\n      ...,\n      markDefs[]{\n        ...,\n        _type == \'file\' => {\n          "href": @.asset->url\n        },\n\n        _type == "exerciseV2Link" => {\n          "exerciseSlug": @.reference->slug.current,\n          "strengthSlug": $strengthSlug\n        }\n      }\n    }\n  },\n\n  teacherNotes[]{\n    ...,\n    markDefs[]{\n      ...,\n      _type == \'file\' => {\n        "href": @.asset->url\n      },\n\n      _type == "exerciseV2Link" => {\n        "exerciseSlug": @.reference->slug.current,\n        "strengthSlug": $strengthSlug\n      }\n    }\n  }\n}\n\n| order(orderNumber asc, title asc)',{language:(null==t?void 0:t.language)||u,strengthSlug:(null==t?void 0:t.strengthSlug)||(null==l?void 0:l.slug),audienceSlug:(null==t?void 0:t.audienceSlug)||i||n}),r);e.setExercises(s),e.setError({type:we.fetchExercises,value:void 0})}catch(t){var c;e.setError({type:we.fetchExercises,value:{error:t,status:null===(c=t.response)||void 0===c?void 0:c.status}})}finally{e.setRequestTimestamps({type:Y.fresh,value:Date.now()}),e.setStatus({type:we.fetchExercises,value:B.complete})}}),findExercise:l(async(e,t,{getState:s})=>{const{exercises:a}=s();return a.find(e=>e.slug===t.slug)})},Ge=_({},ke,Ie,Ee,Me),Ae={setError:u((e,t)=>{e.error[t.type]=t.value}),setFirstGoalFlag:u((e,t)=>{e.firstGoalFlag=t}),setGoals:u((e,t)=>{e.goals=t}),setRequestTimestamps:u((e,t)=>{e.requestTimestamps[t.type]=t.value}),setStatus:u((e,t)=>{e.status[t.type]=t.value})},xe={onSetStatus:c(e=>e.setStatus,(e,t)=>{t.payload.value===B.complete&&e.setStatus({type:t.payload.type,value:B.idle})})};var je;!function(e){e.createGoal="createGoal",e.editGoal="editGoal",e.deleteGoal="deleteGoal",e.fetchGoals="fetchGoals"}(je||(je={}));const Re={error:{},firstGoalFlag:!1,goals:[],requestTimestamps:{fresh:0,stale:0},status:Object.keys(je).reduce((e,t)=>_({},e,{[je[t]]:B.idle}),{})},Ce=e=>{var t;return{modifiedAt:e.ModifiedAt,createdAt:e.CreatedAt,id:e.ID,actTargetCount:e.ActTargetCount,creatorId:e.CreatorID,groupId:e.GroupID,actTemplates:null===(t=e.ActTemplates)||void 0===t?void 0:t.map(e=>({text:e.Text,strengthSlug:e.StrengthSlug}))}},$e=_({},Ae,xe,Re,{createGoal:l(async(e,t,{getState:s,getStoreActions:a,injections:{client:i}})=>{e.setStatus({type:je.createGoal,value:B.loading}),await a().auth.silentRefresh();try{const a=await i.post((({groupId:e})=>`${$.groups}/${e}/${$.goals}`)({groupId:t.groupId}),{ActTargetCount:t.actTargetCount,ActTemplates:t.actTemplates}).then(({data:e})=>Ce(e)),{goals:n}=s();e.setFirstGoalFlag(0===n.length),e.setGoals([a,...n]),e.setError({type:je.createGoal,value:void 0})}catch(t){var n;e.setError({type:je.createGoal,value:{error:t,status:null===(n=t.response)||void 0===n?void 0:n.status}})}finally{e.setRequestTimestamps({type:Y.stale,value:Date.now()}),e.setStatus({type:je.createGoal,value:B.complete})}}),deleteGoal:l(async(e,t,{getState:s,getStoreActions:a,injections:{client:i}})=>{e.setStatus({type:je.deleteGoal,value:B.loading}),await a().auth.silentRefresh();try{await i.delete((({groupId:e,goalId:t})=>`${$.groups}/${e}/${$.goals}/${t}`)(t));const{goals:a}=s(),n=a.filter(e=>e.id!==t.goalId);e.setGoals(n.length?n:[]),e.setError({type:je.deleteGoal,value:void 0})}catch(t){var n;e.setError({type:je.deleteGoal,value:{error:t,status:null===(n=t.response)||void 0===n?void 0:n.status}})}finally{e.setRequestTimestamps({type:Y.stale,value:Date.now()}),e.setStatus({type:je.deleteGoal,value:B.complete})}}),editGoal:l(async(e,t,{getState:s,getStoreActions:a,injections:{client:i}})=>{e.setStatus({type:je.editGoal,value:B.loading}),await a().auth.silentRefresh();try{const a=await i.put((({groupId:e,goalId:t})=>`${$.groups}/${e}/${$.goals}/${t}`)({groupId:t.groupId,goalId:t.goalId}),{ActTargetCount:t.actTargetCount,ActTemplates:t.actTemplates}).then(({data:e})=>Ce(e)),{goals:n}=s(),o=[...n];o[n.findIndex(e=>e.id===t.goalId)]=a,e.setGoals(o),e.setError({type:je.editGoal,value:void 0})}catch(t){var n;e.setError({type:je.editGoal,value:{error:t,status:null===(n=t.response)||void 0===n?void 0:n.status}})}finally{e.setRequestTimestamps({type:Y.stale,value:Date.now()}),e.setStatus({type:je.editGoal,value:B.complete})}}),fetchGoals:l(async(e,t,{getState:s,getStoreActions:a,injections:{client:i}})=>{if(s().status[je.fetchGoals]===B.idle){e.setStatus({type:je.fetchGoals,value:B.loading}),await a().auth.silentRefresh();try{const{requestTimestamps:{fresh:a,stale:n}}=s(),o=a<n,r=await i.get((({groupId:e})=>`${$.groups}/${e}/${$.goals}`)({groupId:t.groupId}),{clearCacheEntry:o}).then(({data:e})=>null==e?void 0:e.map(e=>Ce(e)));e.setGoals(r||[]),e.setError({type:je.fetchGoals,value:void 0})}catch(t){var n;e.setError({type:je.fetchGoals,value:{error:t,status:null===(n=t.response)||void 0===n?void 0:n.status}})}finally{e.setRequestTimestamps({type:Y.fresh,value:Date.now()}),e.setStatus({type:je.fetchGoals,value:B.complete})}}})}),qe={setError:u((e,t)=>{e.error[t.type]=t.value}),setGroupInvitations:u((e,t)=>{e.invitations=t}),setInvitation:u((e,t)=>{e.invitation=t}),setRequest:u((e,t)=>{e.request[t.type]=t.value}),setRequestTimestamps:u((e,t)=>{e.requestTimestamps[t.type]=t.value}),setStatus:u((e,t)=>{e.status[t.type]=t.value})},De={onSetGroupInvitations:c(e=>e.setGroupInvitations,async(e,t,{getStoreState:s,getStoreActions:a})=>{const{selectedGroup:i}=s().groups;if(!i)return;const n=_({},i,{invitations:t.payload});a().groups.setSelectedGroup(n)}),onSetStatus:c(e=>e.setStatus,(e,t)=>{t.payload.value===B.complete&&e.setStatus({type:t.payload.type,value:B.idle})})};var Pe;!function(e){e.acceptInvitation="acceptInvitation",e.deleteInvitation="deleteInvitation",e.fetchInvitation="fetchInvitation",e.fetchInvitations="fetchInvitations",e.sendInvitation="sendInvitation",e.resendInvitation="resendInvitation"}(Pe||(Pe={}));const Le={error:{},invitation:void 0,invitations:[],request:Object.keys(Pe).reduce((e,t)=>_({},e,{[Pe[t]]:void 0}),{}),requestTimestamps:{fresh:0,stale:0},status:Object.keys(Pe).reduce((e,t)=>_({},e,{[Pe[t]]:B.idle}),{})},Oe={acceptInvitation:l(async(e,t,{getState:s,getStoreActions:a,injections:{client:i}})=>{if(s().status.acceptInvitation===B.idle){e.setStatus({type:Pe.acceptInvitation,value:B.loading}),await a().auth.silentRefresh();try{await i.post((({invitationId:e})=>`${$.invitations}/${e}/acceptance`)(t)),e.setError({type:Pe.acceptInvitation,value:void 0})}catch(t){var n;e.setError({type:Pe.acceptInvitation,value:{error:t,status:null===(n=t.response)||void 0===n?void 0:n.status}})}finally{e.setRequestTimestamps({type:Y.stale,value:Date.now()}),e.setStatus({type:Pe.acceptInvitation,value:B.complete})}}}),deleteInvitation:l(async(e,t,{getState:s,getStoreActions:a,injections:{client:i}})=>{if(s().status.deleteInvitation===B.idle){e.setStatus({type:Pe.deleteInvitation,value:B.loading}),await a().auth.silentRefresh();try{await i.delete((({invitationId:e})=>`${$.invitations}/${e}`)(t));const a=s().invitations.filter(e=>e.id!==t.invitationId);e.setGroupInvitations(a),e.setError({type:Pe.deleteInvitation,value:void 0})}catch(t){var n;e.setError({type:Pe.deleteInvitation,value:{error:t,status:null===(n=t.response)||void 0===n?void 0:n.status}})}finally{e.setRequestTimestamps({type:Y.stale,value:Date.now()}),e.setStatus({type:Pe.deleteInvitation,value:B.complete})}}}),fetchInvitation:l(async(e,t,{getState:s,getStoreActions:a,injections:{client:i}})=>{if(s().status.fetchInvitation===B.idle){e.setStatus({type:Pe.fetchInvitation,value:B.loading}),await a().auth.silentRefresh();try{const{requestTimestamps:{fresh:a,stale:n}}=s(),o=a<n,r=await i.get((({token:e})=>`${$.invitations}?token=${e}`)(t),{clearCacheEntry:o}).then(({data:e})=>V(e));e.setInvitation(r),e.setError({type:Pe.fetchInvitation,value:void 0})}catch(t){var n;e.setError({type:Pe.fetchInvitation,value:{error:t,status:null===(n=t.response)||void 0===n?void 0:n.status}})}finally{e.setRequestTimestamps({type:Y.fresh,value:Date.now()}),e.setStatus({type:Pe.fetchInvitation,value:B.complete})}}}),fetchInvitations:l(async(e,t,{getState:s,getStoreState:a,getStoreActions:i,injections:{client:n}})=>{const o=s().request.fetchInvitations;o&&o.cancel(),await i().auth.silentRefresh();const r=v.CancelToken.source();e.setStatus({type:Pe.fetchInvitations,value:B.loading}),e.setRequest({type:Pe.fetchInvitations,value:r});try{const{requestTimestamps:{fresh:i,stale:o}}=s(),u=i<o,l=await n.get((({groupId:e})=>`${$.groups}/${e}/${$.invitations}`)(t),{cancelToken:r.token,clearCacheEntry:u}).then(({data:e})=>e.map(e=>V(e))),{groups:c}=a().groups,d=null==c?void 0:c.find(e=>e.id===t.groupId);e.setGroupInvitations((null==d?void 0:d.invitations)?[...d.invitations,...l]:l),e.setError({type:Pe.fetchInvitations,value:void 0})}catch(t){var u;e.setError({type:Pe.fetchInvitations,value:{error:t,status:null===(u=t.response)||void 0===u?void 0:u.status}})}finally{e.setRequestTimestamps({type:Y.fresh,value:Date.now()}),e.setStatus({type:Pe.fetchInvitations,value:B.complete})}}),sendInvitation:l(async(e,t,{getState:s,getStoreActions:a,injections:{client:i}})=>{if(s().status.sendInvitation===B.idle){e.setStatus({type:Pe.sendInvitation,value:B.loading}),await a().auth.silentRefresh();try{const a=await i.post((({groupId:e})=>`${$.groups}/${e}/members`)({groupId:t.groupId}),{Email:t.email,Role:t.role,Type:t.invitationType}).then(({data:e})=>V(e)),{invitations:n}=s();e.setGroupInvitations([...n,a]),e.setError({type:Pe.sendInvitation,value:void 0})}catch(t){var n;e.setError({type:Pe.sendInvitation,value:{error:t,status:null===(n=t.response)||void 0===n?void 0:n.status}})}finally{e.setRequestTimestamps({type:Y.stale,value:Date.now()}),e.setStatus({type:Pe.sendInvitation,value:B.complete})}}}),resendInvitation:l(async(e,t,{getState:s,getStoreActions:a,injections:{client:i}})=>{if(s().status.resendInvitation===B.idle){e.setStatus({type:Pe.resendInvitation,value:B.loading}),await a().auth.silentRefresh();try{await i.post((({invitationId:e})=>`${$.invitations}/${e}/resend`)(t)),e.setError({type:Pe.resendInvitation,value:void 0})}catch(t){var n;e.setError({type:Pe.resendInvitation,value:{error:t,status:null===(n=t.response)||void 0===n?void 0:n.status}})}finally{e.setRequestTimestamps({type:Y.stale,value:Date.now()}),e.setStatus({type:Pe.resendInvitation,value:B.complete})}}})},Ve=d(_({},qe,De,Le,Oe),{storage:"localStorage",allow:["invitations"]}),Ue={setError:u((e,t)=>{e.error[t.type]=t.value}),setMemberships:u((e,t)=>{e.memberships=t}),setRequest:u((e,t)=>{e.request[t.type]=t.value}),setRequestTimestamps:u((e,t)=>{e.requestTimestamps[t.type]=t.value}),setStatus:u((e,t)=>{e.status[t.type]=t.value})},Fe={onSetMemberships:c(e=>e.setMemberships,async(e,t,{getStoreState:s,getStoreActions:a})=>{const{selectedGroup:i}=s().groups;if(!i)return;const n=_({},i,{memberships:t.payload});a().groups.setSelectedGroup(n)}),onSetStatus:c(e=>e.setStatus,(e,t)=>{t.payload.value===B.complete&&e.setStatus({type:t.payload.type,value:B.idle})})};var Ne;!function(e){e.deleteMembership="deleteMembership",e.editMembership="editMembership",e.fetchMemberships="fetchMemberships"}(Ne||(Ne={}));const He={error:{},memberships:[],request:Object.keys(Ne).reduce((e,t)=>_({},e,{[Ne[t]]:void 0}),{}),requestTimestamps:{fresh:0,stale:0},status:Object.keys(Ne).reduce((e,t)=>_({},e,{[Ne[t]]:B.idle}),{})},Ke={deleteMembership:l(async(e,t,{getState:s,getStoreActions:a,injections:{client:i}})=>{if(s().status.deleteMembership===B.idle){e.setStatus({type:Ne.deleteMembership,value:B.loading}),await a().auth.silentRefresh();try{await i.delete((({groupId:e,memberId:t})=>`${$.groups}/${e}/members/${t}`)({groupId:t.groupId,memberId:t.memberId})).then(({data:e})=>L(e));const{memberships:a}=s();if(!a)return;const n=a.filter(e=>e.user.id!==t.memberId);e.setMemberships(n),e.setError({type:Ne.deleteMembership,value:void 0})}catch(t){var n;e.setError({type:Ne.deleteMembership,value:{error:t,status:null===(n=t.response)||void 0===n?void 0:n.status}})}finally{e.setRequestTimestamps({type:Y.stale,value:Date.now()}),e.setStatus({type:Ne.deleteMembership,value:B.complete})}}}),editMembership:l(async(e,t,{getState:s,getStoreActions:a,injections:{client:i}})=>{if(s().status.editMembership===B.idle){e.setStatus({type:Ne.editMembership,value:B.loading}),await a().auth.silentRefresh();try{const a=await i.put((({groupId:e,memberId:t})=>`${$.groups}/${e}/members/${t}`)({groupId:t.groupId,memberId:t.membership.user.id}),{data:t.membership}).then(({data:e})=>L(e)),{memberships:n}=s();if(!n)return;const o=[...n],r=o.findIndex(e=>e.id===a.id);o[r]=a,e.setMemberships(o),e.setError({type:Ne.editMembership,value:void 0})}catch(t){var n;e.setError({type:Ne.editMembership,value:{error:t,status:null===(n=t.response)||void 0===n?void 0:n.status}})}finally{e.setRequestTimestamps({type:Y.stale,value:Date.now()}),e.setStatus({type:Ne.editMembership,value:B.complete})}}}),fetchMemberships:l(async(e,t,{getState:s,getStoreActions:a,injections:{client:i}})=>{const n=s().request.fetchMemberships;n&&n.cancel(),await a().auth.silentRefresh();const o=v.CancelToken.source();e.setStatus({type:Ne.fetchMemberships,value:B.loading}),e.setRequest({type:Ne.fetchMemberships,value:o});try{const{requestTimestamps:{fresh:a,stale:n}}=s(),r=a<n,u=await i.get((({groupId:e})=>`${$.groups}/${e}/${$.members}`)(t),{cancelToken:o.token,clearCacheEntry:r}).then(({data:e})=>(e=>e.map(e=>({user:{id:e.ID,familyName:e.FamilyName,givenName:e.GivenName,name:[e.GivenName,e.FamilyName].filter(Boolean).join(" ")},role:e.Role})).sort((e,t)=>e.role<t.role?-1:e.role>t.role?1:e.user.name&&t.user.name&&e.user.name<t.user.name?-1:e.user.name&&t.user.name&&e.user.name>t.user.name?1:0))(e));e.setMemberships(u),e.setError({type:Ne.fetchMemberships,value:void 0})}catch(t){var r;e.setError({type:Ne.fetchMemberships,value:{error:t,status:null===(r=t.response)||void 0===r?void 0:r.status}})}finally{e.setStatus({type:Ne.fetchMemberships,value:B.complete}),e.setRequestTimestamps({type:Y.fresh,value:Date.now()}),e.setRequest({type:Ne.fetchMemberships,value:void 0})}})},ze=d(_({},Ue,Fe,He,Ke),{storage:"localStorage",allow:["memberships"]}),Be={setCursor:u((e,t)=>{e.cursor=t}),setError:u((e,t)=>{e.error[t.type]=t.value}),setFirstMomentFlag:u((e,t)=>{e.firstMomentFlag=t}),setMoments:u((e,t)=>{e.moments=t}),setRequestTimestamps:u((e,t)=>{e.requestTimestamps[t.type]=t.value}),setStatus:u((e,t)=>{e.status[t.type]=t.value}),setTempMoments:u((e,t)=>{e.tempMoments=t})},We={onSetStatus:c(e=>e.setStatus,(e,t)=>{t.payload.value===B.complete&&e.setStatus({type:t.payload.type,value:B.idle})})};var Je;!function(e){e.createMoment="createMoment",e.createMomentMedia="createMomentMedia",e.deleteMoment="deleteMoment",e.deleteMomentMedia="deleteMomentMedia",e.editMoment="editMoment",e.fetchMoments="fetchMoments",e.fetchMoreMoments="fetchMoreMoments"}(Je||(Je={}));const Ye={cursor:void 0,error:{},firstMomentFlag:!1,moments:[],moreMomentsExist:r(({cursor:e})=>!!e),requestTimestamps:{fresh:0,stale:0},status:Object.keys(Je).reduce((e,t)=>_({},e,{[Je[t]]:B.idle}),{}),tempMoments:[]},Xe=e=>({createdAt:new Date(e.CreatedAt),creatorId:e.CreatorID,creatorName:D(e.Creator.GivenName,e.Creator.FamilyName),description:e.Description,groupId:e.GroupID,groupName:e.Group.Name,id:e.ID,mediaId:e.MediaID,mediaType:e.MediaType,mediaUrl:e.MediaID&&Qe(e.MediaID),strengthSlug:e.StrengthSlug,goalId:e.GoalID}),Qe=e=>`${$.media}/${e}`,Ze={createMoment:l(async(e,t,{getState:s,getStoreActions:a,injections:{client:i}})=>{e.setStatus({type:Je.createMoment,value:B.loading});const{moments:n}=s();try{await a().auth.silentRefresh();let s=await i.post((({groupId:e})=>`${$.groups}/${e}/moments`)({groupId:t.groupId}),{strengthSlug:t.strengthSlug,description:t.description,goalId:t.goalId}).then(({data:e})=>Xe(e));if(t.media){const a=await e.createMomentMedia({media:t.media,moment:s});a.mediaUrl&&(s=a)}e.setFirstMomentFlag(0===n.length),e.setMoments([s,...n]),e.setError({type:Je.createMoment,value:void 0})}catch(t){var o;e.setError({type:Je.createMoment,value:{error:t,status:null===(o=t.response)||void 0===o?void 0:o.status}})}finally{e.setRequestTimestamps({type:Y.stale,value:Date.now()}),e.setStatus({type:Je.createMoment,value:B.complete})}}),createMomentMedia:l(async(e,t,{getState:s,getStoreActions:a,injections:{client:i}})=>{e.setStatus({type:Je.createMomentMedia,value:B.loading});const n=(e=>{if(e.type.includes("image"))return"image"})(t.media);if(!n)return;const{tempMoments:o}=s(),r=[t.moment,...o];let u;e.setTempMoments(r);try{await a().auth.silentRefresh();const s=new FormData;s.append("file",t.media),s.append("mediaType",n);const o=await i.post((({momentId:e})=>`${$.media}?momentID=${e}`)({momentId:t.moment.id}),s,{onUploadProgress:s=>{u=r.findIndex(({id:e})=>e===t.moment.id);const a=Array.from(r);a[u]=_({},a[u],{progress:Math.round(100*s.loaded/s.total)}),e.setTempMoments(a)}}).then(({data:e})=>(e=>({id:e.ID,modifiedAt:e.ModifiedAt,momentId:e.MomentID,type:e.Type,uploaderId:e.UploaderID}))(e));return e.setError({type:Je.createMomentMedia,value:void 0}),_({},t.moment,{mediaUrl:Qe(o.id),mediaId:o.id,mediaType:o.type})}catch(t){var l;return e.setError({type:Je.createMomentMedia,value:{error:t,status:null===(l=t.response)||void 0===l?void 0:l.status}})}finally{u=r.findIndex(e=>e.id===t.moment.id),r.splice(u,1),e.setTempMoments(r),e.setRequestTimestamps({type:Y.stale,value:Date.now()}),e.setStatus({type:Je.createMomentMedia,value:B.complete})}}),deleteMoment:l(async(e,t,{getState:s,getStoreActions:a,injections:{client:i}})=>{if(s().status.deleteMoment===B.idle){e.setStatus({type:Je.deleteMoment,value:B.loading});try{await a().auth.silentRefresh();const{moments:n}=s(),o=Array.from(n),r=o.findIndex(({id:e})=>e===t.momentId),u=o[r];u.mediaId&&await e.deleteMomentMedia({mediaId:u.mediaId}),await i.delete((({groupId:e,momentId:t})=>`${$.groups}/${e}/moments/${t}`)({groupId:t.groupId,momentId:t.momentId})),o.splice(r,1),e.setMoments(o),e.setError({type:Je.deleteMoment,value:void 0})}catch(t){var n;e.setError({type:Je.deleteMoment,value:{error:t,status:null===(n=t.response)||void 0===n?void 0:n.status}})}finally{e.setRequestTimestamps({type:Y.stale,value:Date.now()}),e.setStatus({type:Je.deleteMoment,value:B.complete})}}}),deleteMomentMedia:l(async(e,t,{getState:s,getStoreActions:a,injections:{client:i}})=>{if(s().status.deleteMomentMedia===B.idle){e.setStatus({type:Je.deleteMomentMedia,value:B.loading});try{await a().auth.silentRefresh(),await i.delete((({mediaId:e})=>`${$.media}/${e}`)(t)),e.setError({type:Je.deleteMomentMedia,value:void 0})}catch(t){var n;e.setError({type:Je.deleteMomentMedia,value:{error:t,status:null===(n=t.response)||void 0===n?void 0:n.status}})}finally{e.setRequestTimestamps({type:Y.stale,value:Date.now()}),e.setStatus({type:Je.deleteMomentMedia,value:B.complete})}}}),editMoment:l(async(e,t,{getState:s,getStoreActions:a,injections:{client:i}})=>{if(s().status.editMoment===B.idle){e.setStatus({type:Je.editMoment,value:B.loading});try{await a().auth.silentRefresh();let n=await i.put((({groupId:e,momentId:t})=>`${$.groups}/${e}/moments/${t}`)({momentId:t.momentId,groupId:t.groupId}),{strengthSlug:t.strengthSlug,description:t.description}).then(({data:e})=>Xe(e));const{moments:o}=s(),r=Array.from(o),u=o.findIndex(e=>e.id===t.momentId);n.mediaId&&(void 0===t.mediaUrl||t.media)&&(await e.deleteMomentMedia({mediaId:n.mediaId}),n=_({},n,{mediaUrl:void 0,mediaType:void 0,mediaId:void 0})),t.media&&(n=await e.createMomentMedia({media:t.media,moment:n})),r[u]=n,e.setMoments(r),e.setError({type:Je.editMoment,value:void 0})}catch(t){var n;e.setError({type:Je.editMoment,value:{error:t,status:null===(n=t.response)||void 0===n?void 0:n.status}})}finally{e.setRequestTimestamps({type:Y.stale,value:Date.now()}),e.setStatus({type:Je.editMoment,value:B.complete})}}}),fetchMoments:l(async(e,t,{getState:s,getStoreActions:a,injections:{client:i}})=>{const n=t.cursor&&!t.resetCursor?Je.fetchMoreMoments:Je.fetchMoments;if(s().status[n]===B.idle){e.setStatus({type:n,value:B.loading}),t.resetCursor&&e.setCursor(void 0);try{await a().auth.silentRefresh();const{requestTimestamps:{fresh:o,stale:r}}=s(),u=o<r,l=await i.get((({groupId:e,cursor:t,count:s})=>`${$.groups}/${e}/moments${t&&s?`?cursor=${t}&count=${s}`:""}${t&&!s?"?cursor="+t:""}${!t&&s?"?count="+s:""}`)(_({},t,{cursor:t.resetCursor?void 0:t.cursor})),{clearCacheEntry:u||t.clearCacheEntry}).then(({data:e})=>e),c=(e=>e.map(e=>Xe(e)))(l.Items);e.setMoments(t.cursor?[...s().moments,...c]:c),e.setCursor(l.Cursor),e.setError({type:n,value:void 0})}catch(t){var o;e.setError({type:n,value:{error:t,status:null===(o=t.response)||void 0===o?void 0:o.status}})}finally{e.setRequestTimestamps({type:Y.fresh,value:Date.now()}),e.setStatus({type:n,value:B.complete})}}})},et=_({},Be,We,Ye,Ze);var tt,st,at;(tt||(tt={})).fetchIllustrationUrl="fetchIllustrationUrl",function(e){e.production="production",e.development="development"}(st||(st={})),function(e){e.fairness="fairness",e.joy="joy",e.start="start"}(at||(at={}));const it={dataset:st.production,error:{},project:"uxuhnfll",sanityClient:r(e=>w({projectId:e.project,dataset:e.dataset,token:e.token,useCdn:!e.token,ignoreBrowserTokenWarning:!0})),status:Object.keys(tt).reduce((e,t)=>_({},e,{[tt[t]]:B.idle}),{}),verboseContent:!1},nt={setDataset:u((e,t)=>{e.dataset=t}),setError:u((e,t)=>{e.error[t.type]=t.value}),setStatus:u((e,t)=>{e.status[t.type]=t.value}),setVerboseContent:u((e,t)=>{e.verboseContent=t})},ot={fetchIllustrationUrl:l(async(e,t,{getState:s})=>{e.setStatus({type:tt.fetchIllustrationUrl,value:B.loading});const{sanityClient:a}=s();try{const s=await a.fetch('*[_type == "illustration" && slug.current == $slug]{...image}[0]',{slug:t.slug}),i=await e.getImageUrlBuilder(s).width(t.width).height(t.height).url();return e.setError({type:tt.fetchIllustrationUrl,value:void 0}),i}catch(t){var i;return e.setError({type:tt.fetchIllustrationUrl,value:{error:t,status:null===(i=t.response)||void 0===i?void 0:i.status}})}finally{e.setStatus({type:tt.fetchIllustrationUrl,value:B.complete})}}),getImageUrlBuilder:l((e,t,{getState:s})=>b(s().sanityClient).image(t))},rt=d(_({},it,nt,ot),{storage:"localStorage",allow:["verboseContent"]}),ut={setActiveStrengthSlug:u((e,t)=>{e.activeStrengthSlug=t}),setError:u((e,t)=>{e.error[t.type]=t.value}),setPositiveCV:u((e,t)=>{e.positiveCV=t}),setRequestTimestamps:u((e,t)=>{e.requestTimestamps[t.type]=t.value}),setStartingLesson:u((e,t)=>{e.startingLesson=t}),setStatus:u((e,t)=>{e.status[t.type]=t.value}),setStrengthPowerPointUrl:u((e,t)=>{e.strengthPowerPointUrl=t}),setStrengths:u((e,t)=>{e.strengths=t}),setXmasCalendar:u((e,t)=>{e.xmasCalendar=t})},lt={onSetStatus:c(e=>e.setStatus,(e,t)=>{t.payload.value===B.complete&&e.setStatus({type:t.payload.type,value:B.idle})})};var ct,dt;!function(e){e.carefulness="carefulness",e.compassion="compassion",e.courage="courage",e.creativity="creativity",e.curiosity="curiosity",e.enthusiasm="enthusiasm",e.fairness="fairness",e.forgiveness="forgiveness",e.gratitude="gratitude",e.grit="grit",e.honesty="honesty",e.hope="hope",e.humour="humour",e.judgement="judgement",e.kindness="kindness",e.leadership="leadership",e.love="love",e.loveOfBeauty="love-of-beauty",e.loveOfLearning="love-of-learning",e.modesty="modesty",e.perseverance="perseverance",e.perspective="perspective",e.positiveCV="positive-cv",e.selfRegulation="self-regulation",e.socialIntelligence="social-intelligence",e.spirituality="spirituality",e.teamwork="teamwork",e.xmasCalendar="xmas-calendar"}(ct||(ct={})),function(e){e.slidesPowerpoint="slidesPowerpoint"}(dt||(dt={}));const pt=(e,t,s,a)=>{let i=t&&s?e+" [DRAFT]":e;return i=a&&s?`${e} ${function({inTeach:e=!1,inSeeTheGood:t=!1}){return`[${e?"TEACH":""}${e&&t?" & ":""}${t?"STG":""}]`}(a)}`:e,i};var mt;!function(e){e.fetchStrengths="fetchStrengths",e.fetchStrengthAttachment="fetchStrengthAttachment"}(mt||(mt={}));const gt={activeStrength:r(e=>e.activeStrengthSlug===ct.xmasCalendar?e.xmasCalendar:e.activeStrengthSlug===ct.positiveCV?e.positiveCV:e.activeStrengthSlug&&de(e.strengths,"slug",e.activeStrengthSlug)),activeStrengthSlug:void 0,error:{},positiveCV:void 0,requestTimestamps:{fresh:0,stale:0},startingLesson:void 0,status:Object.keys(mt).reduce((e,t)=>_({},e,{[mt[t]]:B.idle}),{}),stgStrengths:r(e=>e.strengths.filter(e=>e.live.inSeeTheGood)),strengthPackages:r([e=>e.strengths,(e,t)=>t.settings.language,(e,t)=>t.audiences.activeAudienceSlug,(e,t)=>t.audiences.defaultAudienceSlug],(e,t,s,a)=>(({language:e=T.fi,audienceSlug:t,strengths:s})=>{if(!e||!s)return{core:[],waves:[],hasWavesContent:!1};const a=[ct.selfRegulation,ct.perseverance,ct.kindness],i=s.filter(e=>a.includes(e.slug)).sort((e,t)=>a.indexOf(e.slug)-a.indexOf(t.slug));let n,o,r,u,l,c,d,p,m,g,v,h,f,y,S=[],k=!1;return e===T.fi&&("preschool"===t&&(n=[ct.compassion,ct.courage,ct.teamwork],p=s.filter(e=>n.includes(e.slug)),S=[p],k=!1),"early_years"===t&&(n=[ct.creativity,ct.compassion,ct.courage],p=s.filter(e=>n.includes(e.slug)),S=[p],k=!1),t&&"students-v2"!==t||(n=[ct.compassion,ct.courage,ct.creativity],o=[ct.curiosity,ct.humour,ct.teamwork],r=[ct.enthusiasm,ct.hope,ct.socialIntelligence],u=[ct.honesty,ct.love,ct.perspective],l=[ct.fairness,ct.leadership,ct.loveOfLearning],c=[ct.carefulness,ct.forgiveness,ct.gratitude,ct.judgement],d=[ct.grit,ct.loveOfBeauty,ct.modesty,ct.spirituality],p=s.filter(e=>n.includes(e.slug)),m=s.filter(e=>o.includes(e.slug)),g=s.filter(e=>r.includes(e.slug)),v=s.filter(e=>u.includes(e.slug)),h=s.filter(e=>l.includes(e.slug)),f=s.filter(e=>c.includes(e.slug)),y=s.filter(e=>d.includes(e.slug)),S=[p,m,g,v,h,f,y],k=!0)),e===T.en&&(t&&"students-v1"===t&&(n=[ct.courage,ct.creativity,ct.humour,ct.teamwork,ct.enthusiasm,ct.socialIntelligence,ct.perspective],p=s.filter(e=>n.includes(e.slug)),S=[p],k=!1),t&&"students-v2"!==t||(n=[ct.compassion,ct.courage,ct.creativity],o=[ct.curiosity,ct.humour,ct.teamwork],r=[ct.enthusiasm,ct.hope,ct.socialIntelligence],u=[ct.honesty,ct.love,ct.perspective],l=[ct.fairness,ct.leadership,ct.loveOfLearning],c=[ct.carefulness,ct.forgiveness,ct.gratitude,ct.judgement],d=[ct.grit,ct.loveOfBeauty,ct.modesty,ct.spirituality],p=s.filter(e=>n.includes(e.slug)),m=s.filter(e=>o.includes(e.slug)),g=s.filter(e=>r.includes(e.slug)),v=s.filter(e=>u.includes(e.slug)),h=s.filter(e=>l.includes(e.slug)),f=s.filter(e=>c.includes(e.slug)),y=s.filter(e=>d.includes(e.slug)),S=[p,m,g,v,h,f,y],k=!0)),{core:i,waves:S,hasWavesContent:k}})({language:t,audienceSlug:s||a,strengths:e})),strengthPowerPointUrl:void 0,strengths:[],teachStrengths:r(e=>e.strengths.filter(e=>e.live.inTeach)),xmasCalendar:void 0},vt=_({},ut,lt,gt,{fetchStrengths:l(async(e,t,{getState:s,getStoreState:a,getStoreActions:i})=>{if(s().status[mt.fetchStrengths]!==B.idle)return;e.setStatus({type:mt.fetchStrengths,value:B.loading}),await i().auth.silentRefresh();const{sanity:{sanityClient:n,verboseContent:o},settings:{language:r},audiences:{defaultAudienceSlug:u}}=a();try{const s=((e,t)=>e.map(e=>{const s=Te(e._id),a=pt(e.name,s,t,e.live),i={id:e._id,color:e.backgroundColor,description:e.description,goalTemplates:e.goalTemplates.map(e=>{const s=Te(e._id),a=pt(e.goalText,s,t);return{actions:e.actions,id:e._id,isDraft:s,name:a,slug:e.slug}}),imageAsset:e.imageAsset,isDraft:Te(e._id),live:e.live,name:a,numExercises:e.numExercises,slug:e.slug};var n;return i.goalTemplates=Array.isArray(i.goalTemplates)?(n=i.goalTemplates.map(e=>e),k(n.reduce((e,t)=>{const{slug:s}=t;return e[s]=e[s]?(i=t,(({id:e})=>(e=>{if(!e)throw new Error("isDraftID called with no id. This is likely caused by the GROQ query not including _id");return e.startsWith("drafts.")})(e))(a=e[s])?a:i):t,e;var a,i},{}))):e.goalTemplates,i}))(await n.fetch("*[_type == 'strengthV2' && defined(nameTranslations[$language])]\n{\n  _id, live, backgroundColor, \"slug\": slug.current, imageAsset\n\n  , \"name\": nameTranslations[$language]\n\n  , ...*[_type == 'strengthV2Translation' && language == $language && references(^._id) && references(*[_type == 'audience' && slug.current == $audienceSlug][0]._id)][0]\n        {description, language}\n\n  , \"goalTemplates\": *[_type == 'goalV2' && defined(translations[$language]) && references(^._id) && references(*[_type == 'audience' && slug.current == $audienceSlug][0]._id)]\n                      {\"slug\": slug.current, _id, ...translations{...@[$language]} }\n                      | order(goalText asc)\n\n  , \"numExercises\": count(*[_type == 'exerciseV2' && references(^._id) && references(*[_type == 'audience' && slug.current == $audienceSlug][0]._id)]\n    {\"translationCount\": count(*[_type == 'exerciseV2Translation' && exerciseV2._ref == ^._id && language == $language])}[ translationCount > 0 ])\n\n} | order(name asc)",{language:(null==t?void 0:t.language)||r,audienceSlug:(null==t?void 0:t.audience)||u}),o),a=I(s,({slug:e,numExercises:t})=>e.includes("positive-cv")&&t)[0],i=I(s,({slug:e,numExercises:t})=>e.includes("xmas-calendar")&&t)[0],l=s.find(({slug:e,numExercises:t})=>e.includes("start")&&t);e.setStrengths(s),e.setPositiveCV(a),e.setXmasCalendar(i),e.setStartingLesson(l),e.setError({type:mt.fetchStrengths,value:void 0})}catch(t){var l;e.setError({type:mt.fetchStrengths,value:{error:t,status:null===(l=t.response)||void 0===l?void 0:l.status}})}finally{e.setRequestTimestamps({type:Y.fresh,value:Date.now()}),e.setStatus({type:mt.fetchStrengths,value:B.complete})}}),fetchStrengthAttachment:l(async(e,t,{getState:s,getStoreState:a,getStoreActions:i})=>{if(s().status[mt.fetchStrengthAttachment]!==B.idle)return;e.setStatus({type:mt.fetchStrengthAttachment,value:B.loading}),await i().auth.silentRefresh();const{sanity:{sanityClient:n},settings:{language:o},audiences:{activeAudienceSlug:r,defaultAudienceSlug:u}}=a(),{activeStrength:l}=s();try{const s=await n.fetch('*[_type == \'strengthV2Attachment\' &&\n  strengthV2->slug.current == $strengthV2Slug &&\n  $audienceSlug in audiences[]->slug.current &&\n  language == $language &&\n  type == $type\n ]{\n   "downloadUrl": file.asset->url + "?dl="\n }[0]',{language:(null==t?void 0:t.language)||o,audienceSlug:(null==t?void 0:t.audience)||r||u,strengthV2Slug:(null==t?void 0:t.strength)||(null==l?void 0:l.slug),type:dt.slidesPowerpoint});e.setStrengthPowerPointUrl(null==s?void 0:s.downloadUrl),e.setError({type:mt.fetchStrengthAttachment,value:void 0})}catch(t){var c;e.setError({type:mt.fetchStrengthAttachment,value:{error:t,status:null===(c=t.response)||void 0===c?void 0:c.status}})}finally{e.setRequestTimestamps({type:Y.fresh,value:Date.now()}),e.setStatus({type:mt.fetchStrengthAttachment,value:B.complete})}})}),ht={setError:u((e,t)=>{e.error[t.type]=t.value}),setLoading:u((e,t)=>{e.loading[t.type]=t.value}),setUser:u((e,t)=>{e.user=t})},ft=_({},{error:{},hasError:r(e=>{return(t=e.error)&&Object.values(t).some(e=>e);var t}),loading:{},isLoading:r(e=>{return(t=e.loading)&&Object.values(t).some(e=>e);var t}),user:void 0},ht),yt=p(),St=yt.useStoreActions,kt=yt.useStoreState,It={audiences:ge,auth:Se,exercises:Ge,goals:$e,groups:ee,invitations:Ve,memberships:ze,moments:et,sanity:rt,settings:oe,strengths:vt,user:ft},wt=({authModel:t,groups:s,baseUrl:a,env:i,sanityConfig:n,settings:o,userModel:r,children:u})=>{C.defaults.baseURL=a;const l=m(_({},It,{auth:_({},It.auth,t),groups:d(_({},It.groups,null==s?void 0:s.model),_({},Z,null==s?void 0:s.persistConfig)),sanity:_({},It.sanity,n),settings:d(_({},It.settings,null==o?void 0:o.model,{env:i}),_({},ne,null==o?void 0:o.persistConfig)),user:_({},It.user,r)}),{injections:{client:C}});return e.createElement(g,{store:l},u)},bt=()=>kt(e=>e.audiences),_t=()=>{const{fetchAudiences:e,setActiveAudienceSlug:t}=St(e=>e.audiences);return{fetchAudiences:e,setActiveAudienceSlug:t}},Tt=()=>kt(e=>e.auth),Et=()=>{const{authenticate:e,initialize:t,logout:s}=St(e=>e.auth);return{authenticate:e,initialize:t,logout:s}},Mt=()=>kt(e=>e.exercises),Gt=()=>{const{fetchExercises:e,findExercise:t,setActiveExerciseSlug:s,setExercises:a}=St(e=>e.exercises);return{fetchExercises:e,findExercise:t,setActiveExerciseSlug:s,setExercises:a}},At=()=>kt(e=>e.goals),xt=()=>{const{createGoal:e,deleteGoal:t,editGoal:s,fetchGoals:a,setFirstGoalFlag:i}=St(e=>e.goals);return{createGoal:e,deleteGoal:t,editGoal:s,fetchGoals:a,setFirstGoalFlag:i}},jt=()=>kt(e=>e.groups),Rt=()=>{const{createGroup:e,deleteGroup:t,editGroup:s,fetchGroups:a,setGroups:i,setSelectedGroup:n,setSelectedGroupId:o}=St(e=>e.groups);return{setSelectedGroup:n,setSelectedGroupId:o,createGroup:e,deleteGroup:t,editGroup:s,fetchGroups:a,setGroups:i}},Ct=()=>kt(e=>e.invitations),$t=()=>{const{acceptInvitation:e,deleteInvitation:t,fetchInvitation:s,fetchInvitations:a,sendInvitation:i,resendInvitation:n}=St(e=>e.invitations);return{acceptInvitation:e,deleteInvitation:t,fetchInvitations:a,fetchInvitation:s,sendInvitation:i,resendInvitation:n,scrubPII:U}},qt=()=>kt(e=>e.memberships),Dt=()=>{const{deleteMembership:e,editMembership:t,fetchMemberships:s}=St(e=>e.memberships);return{deleteMembership:e,editMembership:t,fetchMemberships:s,scrubPII:O}},Pt=()=>kt(e=>e.moments),Lt=()=>{const{createMoment:e,deleteMoment:t,deleteMomentMedia:s,editMoment:a,fetchMoments:i,setFirstMomentFlag:n}=St(e=>e.moments);return{createMoment:e,deleteMoment:t,deleteMomentMedia:s,editMoment:a,fetchMoments:i,setFirstMomentFlag:n}},Ot=()=>kt(e=>e.sanity),Vt=()=>{const{getImageUrlBuilder:e,fetchIllustrationUrl:t}=St(e=>e.sanity);return{getImageUrlBuilder:e,fetchIllustrationUrl:t}},Ut=()=>kt(e=>e.settings),Ft=()=>{const{setLanguage:e,setTheme:t}=St(e=>e.settings);return{setLanguage:e,setTheme:t}},Nt=()=>kt(e=>e.strengths),Ht=()=>{const{fetchStrengths:e,fetchStrengthAttachment:t,setStrengthPowerPointUrl:s,setActiveStrengthSlug:a}=St(e=>e.strengths);return{fetchStrengths:e,fetchStrengthAttachment:t,setStrengthPowerPointUrl:s,setActiveStrengthSlug:a}},Kt=()=>kt(e=>e.user),zt=()=>({scrubPII:P});var Bt,Wt;!function(e){e.email="email",e.link="link"}(Bt||(Bt={})),function(e){e.waiting="waiting",e.accepted="accepted"}(Wt||(Wt={}));export{fe as AuthRequestType,M as Environment,_e as ExerciseSectionKey,be as ExerciseSectionTitle,N as GroupRole,F as GroupType,at as IllustrationSlug,Wt as InvitationStatus,Bt as InvitationType,T as Language,x as LanguageProvider,$ as Path,wt as PositiveProvider,st as SanityDataset,B as Status,ct as StrengthSlug,E as Theme,Se as authModel,ee as groupModel,oe as settingsModel,_t as useAudienceActions,bt as useAudienceState,Et as useAuthActions,Tt as useAuthState,Gt as useExerciseActions,Mt as useExerciseState,xt as useGoalActions,At as useGoalState,Rt as useGroupActions,jt as useGroupState,$t as useInvitationActions,Ct as useInvitationState,Dt as useMembershipActions,qt as useMembershipState,Lt as useMomentActions,Pt as useMomentState,Vt as useSanityActions,Ot as useSanityState,Ft as useSettingsActions,Ut as useSettingsState,Ht as useStrengthActions,Nt as useStrengthState,zt as useUserActions,Kt as useUserState,ft as userModel};
//# sourceMappingURL=index.modern.js.map
